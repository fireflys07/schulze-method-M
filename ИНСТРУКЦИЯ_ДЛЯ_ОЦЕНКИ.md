# Инструкция по использованию метода Шульце для оценки докладов

**Редактор:** Мозжухин Марк

---

## Обзор вашей задачи

У вас две части оценки:
1. **Доклады** (до 6 баллов) - ранжирование выступлений методом Шульце
2. **Вопросы и ответы** (до 4 баллов) - ранжирование по очкам

---

## Часть 1: Оценка докладов методом Шульце

### Как это работает

Каждый оценщик (судья + аудитория) ранжирует **все группы** (кроме своей) по качеству доклада.

### Формат данных для калькулятора

Каждая строка = один оценщик со своим ранжированием.

**Формат:** `количество_голосов:Группа1-Группа2Группа3-Группа4`

**Пример:**
```
1:A-B-CD
1:B-A-CD  
2:D-C-AB
```

**Объяснение:**
- `1:A-B-CD` = один голос, где группа A лучше B, B лучше C и D (C и D равны)
- Дефис `-` разделяет уровни предпочтений
- Без дефиса = равное предпочтение (BC = B и C равны)

### Пример для вашей задачи

Допустим, 5 групп выступили, и есть 3 оценщика:

**Оценщик 1 (судья):** Группа2 > Группа1 > Группа3 = Группа4 = Группа5
```
1:B-A-CDE
```

**Оценщик 2 (студент):** Группа1 > Группа4 > Группа2 > Группа3 = Группа5
```
1:A-D-B-CE
```

**Оценщик 3 (студент):** Группа3 = Группа4 > Группа1 > Группа2 > Группа5
```
1:CD-A-B-E
```

**Вставьте эти строки в калькулятор Шульце, и он автоматически определит итоговый порядок!**

---

## Часть 2: Интеграция с Google Sheets

### Шаг 1: Создайте таблицу для голосования

Создайте Google Sheets с такой структурой:

| Имя оценщика | Тип (судья/аудитория) | Группа1 | Группа2 | Группа3 | Группа4 | Группа5 | Результат |
|--------------|----------------------|---------|---------|---------|---------|---------|-----------|
| Иванов И.И.  | Судья                | 1       | 2       | 3       | 3       | 4       |           |
| Петров П.П.  | Аудитория            | 2       | 1       | 3       | 4       | 5       |           |

**Где:**
- Числа = приоритет (1 = лучшая группа, 2 = вторая, и т.д.)
- Одинаковые числа = равное предпочтение

### Шаг 2: Установите функцию в Google Sheets

1. Откройте Google Sheets
2. Перейдите: **Расширения → Apps Script**
3. Вставьте код из файла `docs/Preferences.js`
4. Сохраните (Ctrl+S) и закройте

### Шаг 3: Используйте формулу

В колонке "Результат" (столбец H) вставьте формулу:

```excel
=PREFERENCES(1;"A";C2:G2;99)
```

**Объяснение параметров:**
- `1` = количество голосов (обычно 1 для каждого оценщика)
- `"A"` = первая буква для обозначения группы (A, B, C...)
- `C2:G2` = диапазон с приоритетами групп
- `99` = значение по умолчанию для пустых ячеек

### Шаг 4: Скопируйте результаты

1. Скопируйте все результаты из колонки "Результат"
2. Вставьте в калькулятор Шульце на сайте или локально
3. Получите итоговый порядок групп
4. Конвертируйте порядок в баллы (1-е место = 6, 2-е = 5, и т.д.)

---

## Пример полного рабочего процесса

### Сценарий: 5 групп, 2 судьи, 3 студента из аудитории

#### В Google Sheets:

| Имя           | Тип       | Группа1 | Группа2 | Группа3 | Группа4 | Группа5 | Результат         |
|---------------|-----------|---------|---------|---------|---------|---------|-------------------|
| Судья 1       | Судья     | 1       | 2       | 3       | 4       | 5       | `=PREFERENCES(1;"A";C2:G2;99)` → `1:A-B-C-D-E` |
| Судья 2       | Судья     | 2       | 1       | 3       | 3       | 4       | → `1:B-A-CD-E` |
| Студент 1     | Аудитория | 1       | 3       | 2       | 4       | 5       | → `1:A-C-B-D-E` |
| Студент 2     | Аудитория | 3       | 1       | 2       | 4       | 5       | → `1:B-C-A-D-E` |
| Студент 3     | Аудитория | 1       | 2       | 4       | 3       | 5       | → `1:A-B-D-C-E` |

#### Скопируйте результаты в калькулятор:

```
1:A-B-C-D-E
1:B-A-CD-E
1:A-C-B-D-E
1:B-C-A-D-E
1:A-B-D-C-E
```

#### Калькулятор выдаст результат типа:
```
By Schulze method: A-B-C-D-E
```

Это означает: Группа1 > Группа2 > Группа3 > Группа4 > Группа5

#### Конвертация в баллы:
- Группа1: 6 баллов
- Группа2: 5 баллов  
- Группа3: 4 балла
- Группа4: 3 балла
- Группа5: 2 балла

---

## Часть 3: Оценка вопросов и ответов (до 4 баллов)

Это проще - здесь просто суммируются очки:

1. **За свои вопросы:** Подсчитайте, сколько групп правильно ответили
2. **За ответы:** Подсчитайте правильные ответы каждой группы
3. **Ранжируйте** группы по общему числу очков (метод Шульце не нужен, достаточно простой сортировки)

Но если вы хотите использовать метод Шульце для ранжирования групп по очкам (когда есть равные результаты), можете использовать ту же систему.

---

## Полезные советы

1. **Тестирование:** Протестируйте на маленьком примере перед реальной защитой
2. **Резервная копия:** Сохраняйте данные голосования
3. **Прозрачность:** Покажите студентам, как работает метод - это повысит доверие
4. **Автоматизация:** Можно создать второй лист в Sheets, который автоматически копирует результаты в нужный формат

---

## Запуск калькулятора локально

Если хотите использовать локальную версию (без интернета):

1. Запустите: `.\mvnw.cmd gwt:run`
2. Откройте браузер на `http://localhost:8888/schulze.jsp`
3. Вставьте данные и получите результат

---

## Вопросы?

Если что-то непонятно, посмотрите:
- Примеры в README.md
- Тестовые данные в проекте
- Живое приложение: http://schulz.webfort.cz

---

**Редактор:** Мозжухин Марк

